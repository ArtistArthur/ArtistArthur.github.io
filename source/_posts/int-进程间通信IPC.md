---
title: 进程间通信IPC
top: false
cover: false
toc: true
mathjax: true
date: 2021-02-06 20:15:49
password:
summary:
tags:
categories:
---
## 进程间通信IPC
通过<Unix Network Program volume 2: Interprocess Communications>学习.  
### Introduction  
IPC的意思是进程间通信.传统上这个术语描述的是运行在同一操作系统上的不同进程之间传递信息的方式.这本书也会描述几种同步(synchronization)的形式.因为更新形式的通信比如共享内存,需要某些形式的同步来实现.  
pipe是最开始广泛被运用的IPC,不仅可以在进程间,也可以在进程和shell间,但是它只能在有共同祖先的进程间起作用(父子之间也行).而命名管道弥补了这个不足.  
<!-- more -->
消息队列(message queue)在1980年代首先被使用在System V中,现在在Unix中基本都可以使用这一方式.消息队列可以在一指定的host上不关联进程间使用.  
Remote Procedure Calls(RPCs,远程过程调用)在1980中期出现.它可以用在服务器和客户端之间,客户端上的一个进程可以调用服务器上的一个函数,以返回结果,这在网络编程中使用.鉴于客户端和服务端可以在同一个主机上,那么RPCs也可以用在进程通信上.   
Unix提供给的几种形式的synchronization:  
早期的程序需要某些形式的同步(synchronization)以阻止多进程同时修改同一文件.  
* Record locking
* semaphores (信号量)
* mutexes and condition variables 是两种形式的同步,经常被用于在线程之间同步,也可以提供进程间的同步.
* read-write locks(读写锁)
#### 1.2 进程,线程, 和信息共享
在传统的Unix编程模型中,我们有多个进程跑在系统中,每个进程有自己的地址空间.信息可以在进程间通过多种方式被共享.  
![进程间通信方式](https://ftp.bmp.ovh/imgs/2021/02/7539c2400224619f.png)  
1. 左边的两个进程通过文件系统中的一个文件共享信息.为了获取数据,每个进程必须通过内核(read, write, lseek等)获取.某些形式的同步在这个过程中是需要的,因为要防止同时读写产生错误.  
2. 中间的两个进程通过内核共享信息.管道,消息队列和信号量(semaphore)就是这种类型的共享.每个获取共享信息的操作都需要一个系统调用.  
3. 右边的两个进程有一块每个进程都可以引用的共享内存.一旦共享内存在进程之间建立起来,之后获取数据的操作便不需要内核参与.某些形式的同步在这个过程中也是需要的.
注意:所有的进程间通信技术都没有限制进程的数量,虽然有时只通过两个进程举例,但是这对多少个进程都是适用的.  
##### 线程
在一个进程中的所有线程共享全局变量.我们必须关心的是大量线程获取这些全局数据的同步情况.虽然同步并不是一个很显然的IPC形式,却被用在许多形式的IPC中以控制对共享信息的获取.  
我们将描述进程间的通信以及线程间的通信.  